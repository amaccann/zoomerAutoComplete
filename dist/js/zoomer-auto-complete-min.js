!function(e,t){"use strict";function n(e){return e=e||5,1609.34*e}function i(e,t,n,i){return e.substring(0,t)+"<strong>"+i+"</strong>"+e.substring(n)}var o,r="Google library missing!",c=e.angular,s=e.google,l=c.module("zoomer-auto-complete",[]),a=500,d=350;o='<div class="z-auto-complete-wrapper"><div class="z-auto-complete-input"><input ng-model="zNgModel" ng-focus="focus()" ng-blur="blur()" type="text" ng-keyup="keyUp($event)"><div ng-if="showDropdown && predictions.length" class="z-auto-complete-results"><ul><li ng-repeat="prediction in predictions" ng-click="setPrediction(prediction)" ng-class="{ selected: prediction.selected, highlight: $index === highlightIndex }"><i class="fa" ng-class="{ \'fa-cog fa-spin\': prediction.selected, \'fa-map-marker\': !prediction.selected }"></i><span ng-bind-html="prediction| zMatchSubStrings"></span></li></ul><p>Powered by <span>Google</span></p></div></div></div>',l.filter("zMatchSubStrings",["$sce",function(e){return function(t){t=t||{};var n,o=t.description||"",r=t.matched_substrings||[];return c.forEach(r,function(e){n=o.substr(e.offset,e.length),o=i(o,e.offset,e.offset+e.length,n)}),e.trustAsHtml(o)}}]),l.directive("zAutoComplete",["$rootScope","$q","$timeout",function(e,i,l){function u(e){var o,l,a=t.createElement("div");this.getLocation=function(){var t=e.locationBias||{},n=t.latitude||t.lat,i=t.longitude||t["long"]||t.lon;return new s.maps.LatLng(n,i)},this.getOptions=function(t){var i=n(e.milesRadius);return{input:t,radius:i,location:this.getLocation()}},this.getPrediction=function(e){var t,n=i.defer();return s?(t=this.getOptions(e),o||(o=new s.maps.places.AutocompleteService),o.getQueryPredictions(t,function(e,t){n.resolve({predictions:e||[],status:t})}),n.promise):(n.reject(r),n.promise)},this.getPlace=function(e){var t=i.defer(),n=this;return s?(l||(l=new s.maps.places.PlacesService(a)),l.getDetails({placeId:e},function(e,i){t.resolve(n.parsePlace(e,i))}),t.promise):(t.reject(r),t.promise)},this.parsePlace=function(e,t){e=e||{};var n=e.address_components||[],i={};return c.forEach(n,function(e){i[e.types[0]]={short_name:e.short_name,long_name:e.long_name}}),{place:i,status:t}}}function p(e,t,n,i){var o,r,s,u,p,g,h=t.find("input"),f=c.element(h[0],f),m="",v=t[0],w=v.className,b=v.id,z=v.getAttribute("name");w=w.replace(/z-auto-complete-wrapper|ng-isolate-scope/gi,""),t.removeAttr("id"),t.removeClass(w),z&&h[0].setAttribute("name",z),h[0].setAttribute("id",b),h.addClass(w),n.zPlaceholder&&h[0].setAttribute("placeholder",n.zPlaceholder),e.showDropdown=!1,e.predictions=[],e.highlightIndex=0,e.selected=null,e.setPrediction=function(t){return t?(t.selected=!0,p(t.place_id)):void(e.predictions.length&&(e.predictions[e.highlightIndex].selected=!0,p(e.predictions[e.highlightIndex].place_id)))},e.parseArrows=function(t){var n=e.predictions.length||0;if(n)return 38===t&&e.highlightIndex>0?void(e.highlightIndex-=1):void(40===t&&e.highlightIndex<n-1&&(e.highlightIndex+=1))},e.keyUp=function(t){var n=t.keyCode,i=h.val().trim();return g&&l.cancel(g),32===n?u(i):13===n?(t.preventDefault(),e.setPrediction()):38===n||40===n?e.parseArrows(n):(e.toggleShowDropdown(!0),void(g=l(function(){u(i)},a)))},e.focus=function(){e.toggleShowDropdown(!0),r()},e.blur=function(){l(function(){e.toggleShowDropdown(!1),s()},d)},e.toggleShowDropdown=function(t){e.$evalAsync(function(){e.showDropdown=!!t})},r=function(){f.on("keydown",function(e){return 13===e.keyCode?(e.preventDefault(),!1):void 0})},s=function(){f.off("keydown")},o=function(){e.highlightIndex=0,e.selected=null,e.predictions=[],e.showDropdown=!1,m=""},u=function(t){t&&""!==t&&t!==m&&(m=t,i.getPrediction(t).then(function(t){t=t||{},e.predictions=t.predictions||[]}))},p=function(t){i.getPlace(t).then(function(t){t=t||{},e.selected=t.place,e.callback(e),h[0].blur(),o()})}}return{controller:["$scope",u],link:p,replace:!0,scope:{locationBias:"=zLocation",callback:"&zAutoComplete",milesRadius:"=zMilesRadius",zNgModel:"=ngModel"},template:o}}])}(window,document);